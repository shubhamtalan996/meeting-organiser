"use strict";(self.webpackChunkmeeting_organiser=self.webpackChunkmeeting_organiser||[]).push([[761],{7478:function(e,n,i){i.d(n,{Z:function(){return r}});var t=i(6015),l=i(4565),o=i(184),r=function(e){var n=e.id,i=e.label,r=e.subTexts,a=e.className,u=e.handleClick;return(0,o.jsxs)(t.Z,{component:"div",display:"flex",flexDirection:"column",className:"cardWrapper ".concat(a),onClick:u,children:[(0,o.jsx)(l.Z,{className:"label",children:i}),r&&(null===r||void 0===r?void 0:r.length)&&r.map((function(e,n){var i=e.key,t=e.label,r=e.value;return(0,o.jsx)(l.Z,{className:"value",children:"".concat(null!==t&&void 0!==t?t:"").concat(null!==r&&void 0!==r?r:"")},i||n)}))]},n)}},8989:function(e,n,i){i.d(n,{G:function(){return o},W:function(){return l}});var t=i(885),l=30,o=function(){var e=(new Date).toLocaleDateString().split("/"),n=(0,t.Z)(e,3),i=n[0],l=n[1],o=n[2],r=(new Date).toLocaleTimeString().split(":"),a=(0,t.Z)(r,2),u=a[0],d=a[1],c=new Date((new Date).getTime()+18e5).toLocaleTimeString().split(":"),v=(0,t.Z)(c,2),s=v[0],m=v[1];return{title:{label:"Title",type:"textfield",value:"Untitled Meeting",error:!1},date:{label:"Selected Date",type:"date",value:"".concat(o,"-").concat(l,"-").concat(i),error:!1},startTime:{label:"Start Time",type:"time",value:"".concat(u,":").concat(d),error:!1},endTime:{label:"End Time",type:"time",value:"".concat(s,":").concat(m),error:!1},building:{label:"Building",type:"select",value:"",error:!1}}}},9761:function(e,n,i){i.r(n),i.d(n,{default:function(){return j}});var t=i(1413),l=i(885),o=i(2791),r=i(6871),a=i(8163),u=i(8402),d=i(70),c=i(7205),v=i(7962),s=i(3171),m=i(7478),f=i(184),g=function(e){var n,i=e.modalConfig,t=e.handleClose,l=e.vacantRooms,o=e.handleCardClick,r=e.bookMeeting;return(0,f.jsx)(s.Z,{open:null!==(n=null===i||void 0===i?void 0:i.open)&&void 0!==n&&n,onClose:t,"aria-labelledby":"parent-modal-title","aria-describedby":"parent-modal-description",children:(0,f.jsx)(v.Z,{in:null===i||void 0===i?void 0:i.open,children:(0,f.jsxs)("div",{className:"modal-wrapper",children:[(0,f.jsx)("h1",{children:"Please select one of the free rooms"}),l&&(null===l||void 0===l?void 0:l.length)>0?l.map((function(e,n){var t,l=e.name,r=e.building,a=e.floor,u=e.id;return(0,f.jsx)(m.Z,{id:"".concat(u||n),className:"room-card ".concat((null===i||void 0===i?void 0:i.selectedCardId)===u&&"selected"),label:l,subTexts:[{key:"".concat(null===r||void 0===r?void 0:r.id),label:"Building: ",value:null!==(t=null===r||void 0===r?void 0:r.name)&&void 0!==t?t:""},{key:"floor",label:"Floor: ",value:null!==a&&void 0!==a?a:""}],handleClick:function(){o&&o(u)}})})):(0,f.jsx)(m.Z,{id:"fallback",className:"room-card fallback",label:"Sorry,",subTexts:[{key:"message",label:"There are no available rooms in this building"}]}),(0,f.jsx)(c.Z,{className:"add-meeting-button",size:"medium",onClick:function(){r&&r()},children:"Next"})]})})})},b=i(8989),Z=i(674),h=i(5987),p=i(4942),T=i(6015),N=i(4565),x=i(336),S=i(9407),y=i(9857),k=["id"],D=function(e){var n=e.meetingRoomForm,i=e.handleMeetingRoomForm,o=e.buildings,r=e.handleModalState,a=function(e,n){i((function(i){return(0,t.Z)((0,t.Z)({},i),{},(0,p.Z)({},e,n))}))};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(T.Z,{component:"div",display:"flex",flexDirection:"column",alignItems:"center",className:"fields-wrapper",alignSelf:"center",children:n&&Object.entries(n).map((function(e){var r=(0,l.Z)(e,2),u=r[0],d=r[1],c=d.label,v=d.type,s=d.value,m=d.error;return(0,f.jsxs)(T.Z,{className:"field-wrapper",children:[(0,f.jsx)(N.Z,{className:"label",children:c}),(0,f.jsxs)(x.Z,{select:"select"===v,value:s,error:m,required:!0,type:v,sx:{m:1,minWidth:250},onChange:function(e){return function(e,o){var r=o.key,u=o.type,d=(0,t.Z)({},n[r]);d.value="select"!==u?e.currentTarget.value:e.target.value;var c=(0,y.K0)(r,d,n);if("startTime"===r&&c){var v,s,m,f=(new Date).toLocaleDateString(),g=null===(v=d)||void 0===v?void 0:v.value.toString().split(":"),h=(0,l.Z)(g,2),T=h[0],N=h[1],x=60*Number(T)+Number(N),S=(null===n||void 0===n||null===(s=n.endTime)||void 0===s||null===(m=s.value)||void 0===m?void 0:m.toString().split(":"))||[],k=(0,l.Z)(S,2),D=k[0],j=k[1],w=60*Number(D)+Number(j);if(x+b.W>=w){var C=(0,t.Z)({},null===n||void 0===n?void 0:n.endTime),R=new Date(Number((0,Z.xS)(f))+60*(x+30)*1e3).toLocaleTimeString().split(":"),M=(0,l.Z)(R,2),$=M[0],L=M[1];C.value="".concat($,":").concat(L),C.error=!1,d.error=!1,i((function(e){var n;return(0,t.Z)((0,t.Z)({},e),{},(n={},(0,p.Z)(n,r,d),(0,p.Z)(n,"endTime",C),n))}))}else d.error=!1,i((function(e){return(0,t.Z)((0,t.Z)({},e),{},(0,p.Z)({},r,d))}))}else c?(d=(0,t.Z)((0,t.Z)({},d),{},{error:!1}),a(r,d)):(d=(0,t.Z)((0,t.Z)({},n[r]),{},{error:!0}),a(r,d))}(e,{key:u,type:v})},children:["select"===v&&(0,f.jsx)(S.Z,{value:"",children:"--"},"-"),"select"===v&&o&&(null===o||void 0===o?void 0:o.length)>0&&(null===o||void 0===o?void 0:o.map((function(e){return(0,f.jsx)(S.Z,{value:null===e||void 0===e?void 0:e.id,children:null===e||void 0===e?void 0:e.name},null===e||void 0===e?void 0:e.id)})))]},u)]},"".concat(u,"-").concat(v))}))}),(0,f.jsx)(c.Z,{className:"add-meeting-button",size:"medium",onClick:function(){var e;if(function(){var e=!0;return Object.entries(n).forEach((function(i){var o=(0,l.Z)(i,2),r=o[0],u=o[1],d=(0,y.K0)(r,u,n),c=(0,t.Z)({},u);c.error=!d,a(r,c),d||(e=!1)})),e}()&&(o&&null!==o&&void 0!==o&&o.length&&null!==n&&void 0!==n&&null!==(e=n.building)&&void 0!==e&&e.value)){var i=null===o||void 0===o?void 0:o.find((function(e){var i,t=e.id;(0,h.Z)(e,k);return t===Number(null===n||void 0===n||null===(i=n.building)||void 0===i?void 0:i.value)}));i&&r(!0,(0,y.yW)(i,n))}},children:"Next"})]})},j=function(){var e,n=(0,o.useContext)(u.A).appRootState.snackbar,i=(0,o.useState)((0,b.G)()),c=(0,l.Z)(i,2),v=c[0],s=c[1],m=(0,r.s0)(),h=(0,o.useState)({open:!1,rooms:[]}),p=(0,l.Z)(h,2),T=p[0],N=p[1],x=(0,a.m3)(d.eP),S=(0,l.Z)(x,2),y=S[0],k=S[1].data,j=(0,a.m3)(d.VD),w=(0,l.Z)(j,2),C=w[0],R=w[1].data,M=(0,a.Db)(d.pg),$=(0,l.Z)(M,1)[0];return(0,o.useEffect)((function(){y(),C()}),[y,C]),(0,f.jsxs)("div",{className:"add-meeting-container",children:[(0,f.jsx)("h1",{children:"Add Meeting"}),(0,f.jsx)(D,{meetingRoomForm:v,handleMeetingRoomForm:s,buildings:null!==(e=null===k||void 0===k?void 0:k.Buildings)&&void 0!==e?e:[],handleModalState:function(e,n){N((function(i){return(0,t.Z)((0,t.Z)({},i),{},{open:e,rooms:n})}))}}),T.open&&(0,f.jsx)(g,{modalConfig:T,handleClose:function(){return N((function(e){return(0,t.Z)((0,t.Z)({},e),{},{open:!1})}))},vacantRooms:null===T||void 0===T?void 0:T.rooms,handleCardClick:function(e){return N((function(n){return(0,t.Z)((0,t.Z)({},n),{},{selectedCardId:e})}))},bookMeeting:function(){if(null!==T&&void 0!==T&&T.selectedCardId){var e,i,t,l,o,r,a={id:Number(null===R||void 0===R||null===(e=R.Meetings)||void 0===e?void 0:e.length)+1,title:null!==(i=null===v||void 0===v||null===(t=v.title)||void 0===t?void 0:t.value)&&void 0!==i?i:"New Meeting",startTime:null===v||void 0===v||null===(l=v.startTime)||void 0===l?void 0:l.value,endTime:null===v||void 0===v||null===(o=v.endTime)||void 0===o?void 0:o.value,meetingRoomId:null===T||void 0===T?void 0:T.selectedCardId,date:(0,Z.RP)(null===v||void 0===v||null===(r=v.date)||void 0===r?void 0:r.value)};$({variables:a}).then((function(e){m("/home")})).catch((function(){}))}else n("No Rooms Available","error")}})]})}},9857:function(e,n,i){i.d(n,{K0:function(){return v},Pi:function(){return d},yW:function(){return c}});var t=i(1413),l=i(885),o=i(8989),r=i(674),a=function(e){var n=e;return"number"!==typeof n?n=1:n++,n},u=function(e,n){var i,t,o,r=null===e||void 0===e?void 0:e.date,a=null===n||void 0===n||null===(i=n.date)||void 0===i?void 0:i.toLocaleDateString(),u=0;null!==n&&void 0!==n&&null!==(t=n.date)&&void 0!==t&&t.getTime()&&(u=Math.floor((null===n||void 0===n||null===(o=n.date)||void 0===o?void 0:o.getTime())/6e4));var d=0,c=0,v=0,s=0;if(null!==e&&void 0!==e&&e.startTime){var m=null===e||void 0===e?void 0:e.startTime.split(":"),f=(0,l.Z)(m,2),g=f[0],b=f[1];Number(g)>0&&(d=60*Number(g)*60),Number(b)>0&&(d+=60*Number(b))}if(null!==e&&void 0!==e&&e.endTime){var Z=null===e||void 0===e?void 0:e.endTime.split(":"),h=(0,l.Z)(Z,2),p=h[0],T=h[1];Number(p)>0&&(c=60*Number(p)*60),Number(T)>0&&(c+=60*Number(T))}return u&&null!==n&&void 0!==n&&n.startTime&&(v=u+(null===n||void 0===n?void 0:n.startTime)),u&&null!==n&&void 0!==n&&n.endTime&&(s=u+(null===n||void 0===n?void 0:n.endTime)),r===a&&(v>d&&v<c||s>d&&s<c)},d=function(e,n){var i={},l=[];if(e&&null!==e&&void 0!==e&&e.length){var o=0,d=0,c=0,v=0,s=0,m=new Date;try{e.forEach((function(e){var n=e.meetingRooms;o=a(o),n&&null!==n&&void 0!==n&&n.length&&n.forEach((function(e){var n=e.meetings;d=a(d);var i=!0;null!==n&&void 0!==n&&n.length&&n.forEach((function(e){e.date===m.toLocaleDateString()&&(v=a(v)),u(e,{date:m,startTime:(0,r.fx)(null===m||void 0===m?void 0:m.toLocaleTimeString()),endTime:(0,r.fx)(null===m||void 0===m?void 0:m.toLocaleTimeString())})&&(i=!1)})),i?c=a(c):s=a(s)}))})),i={totalBuildings:o,totalRooms:d,freeRooms:c,totalMeetingsToday:v,totalMeetingsNow:s},n&&null!==n&&void 0!==n&&n.length&&n.forEach((function(e){var n,o=[];null!==e&&void 0!==e&&null!==(n=e.subTexts)&&void 0!==n&&n.length&&(o=function(e,n){var i=[];return e&&null!==e&&void 0!==e&&e.length&&e.forEach((function(e){var l,o=(0,t.Z)({},e),r=null===e||void 0===e?void 0:e.key;n&&n[r]&&(o.value=null===(l=n[r])||void 0===l?void 0:l.toString()),i.push(o)})),i}(null===e||void 0===e?void 0:e.subTexts,i)),null===l||void 0===l||l.push((0,t.Z)((0,t.Z)({},e),{},{subTexts:o}))}))}catch(f){console.error(f)}}return l},c=function(e,n){var i=[],t=e.meetingRooms;return t&&null!==t&&void 0!==t&&t.length&&t.forEach((function(e){var t=e.meetings,l=!0;t&&null!==t&&void 0!==t&&t.length&&t.forEach((function(e){var i,t,o,a=(0,r.S$)(null===n||void 0===n||null===(i=n.date)||void 0===i?void 0:i.value),d=(0,r.fx)(null===n||void 0===n||null===(t=n.startTime)||void 0===t?void 0:t.value),c=(0,r.fx)(null===n||void 0===n||null===(o=n.endTime)||void 0===o?void 0:o.value);a&&d&&c&&(u(e,{date:a,startTime:d,endTime:c})&&(l=!1))})),l&&i.push(e)})),i},v=function(e,n,i){var t=!0;if(null===n||void 0===n||!n.value)return t=!1;switch(e){case"date":var r=null===n||void 0===n?void 0:n.value.toString().split("-"),a=(0,l.Z)(r,3),u=a[0],d=a[1],c=a[2],v=(new Date).toLocaleDateString().split("/"),s=(0,l.Z)(v,3),m=s[0],f=s[1],g=s[2];+new Date("".concat(d,"/").concat(c,"/").concat(u))<+new Date("".concat(f,"/").concat(m,"/").concat(g))&&(t=!1);break;case"startTime":var b=null===n||void 0===n?void 0:n.value.toString().split(":"),Z=(0,l.Z)(b,2),h=Z[0],p=Z[1],T=(new Date).toLocaleTimeString().split(":"),N=(0,l.Z)(T,2),x=N[0],S=N[1];60*Number(x)+Number(S)>60*Number(h)+Number(p)&&(t=!1);break;case"endTime":var y,k,D=null===n||void 0===n?void 0:n.value.toString().split(":"),j=(0,l.Z)(D,2),w=j[0],C=j[1],R=(null===i||void 0===i||null===(y=i.startTime)||void 0===y||null===(k=y.value)||void 0===k?void 0:k.toString().split(":"))||[],M=(0,l.Z)(R,2),$=M[0],L=M[1],I=(new Date).toLocaleTimeString().split(":"),E=(0,l.Z)(I,2),W=E[0],B=E[1],F=60*Number(W)+Number(B),P=60*Number($)+Number(L),A=60*Number(w)+Number(C);(F>A||P+o.W>A)&&(t=!1)}return t}},70:function(e,n,i){i.d(n,{VD:function(){return l},eP:function(){return o},pg:function(){return t}});var t="mutation AddMeeting($id: Int!,$title: String!\n  $date: String!,\n  $startTime: String!,\n  $endTime: String!,\n  $meetingRoomId:Int!) {\n  Meeting(id: $id, title: $title,startTime: $startTime,endTime: $endTime,date: $date, meetingRoomId: $meetingRoomId) {\n    id\n    title\n    startTime\n    endTime\n    date\n\n  }\n}",l="\nquery Meeting\n{\n  Meetings\n  {\n    title\n    date\n    startTime\n    endTime\n  }\n}",o="query Building {\n  Buildings {\n    name\n    id\n    meetingRooms {\n      id\n      name\n      floor\n      building {\n        id\n        name\n      }\n      meetings {\n        title\n        date\n        startTime\n        endTime\n      }\n    }\n  }\n}"},674:function(e,n,i){i.d(n,{RP:function(){return a},S$:function(){return o},fx:function(){return l},xS:function(){return r}});var t=i(885),l=function(e){if(e){var n=null===e||void 0===e?void 0:e.toString().split(":"),i=(0,t.Z)(n,2),l=i[0],o=i[1];return 60*Number(l)+Number(o)}return 0},o=function(e){if(e){var n=null===e||void 0===e?void 0:e.toString().split("-"),i=(0,t.Z)(n,3),l=i[0],o=i[1],r=i[2];return new Date("".concat(o,"/").concat(r,"/").concat(l))}},r=function(e){if(e){var n=null===e||void 0===e?void 0:e.toString().split("/"),i=(0,t.Z)(n,3),l=i[0],o=i[1],r=i[2];return new Date("".concat(o,"/").concat(l,"/").concat(r))}},a=function(e){if(e){var n=null===e||void 0===e?void 0:e.toString().split("-"),i=(0,t.Z)(n,3),l=i[0],o=i[1],r=i[2];return"".concat(r,"/").concat(o,"/").concat(l)}}}}]);
//# sourceMappingURL=761.cfc5f328.chunk.js.map